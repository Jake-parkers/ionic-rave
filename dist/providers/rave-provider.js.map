{"version":3,"file":"rave-provider.js","sourceRoot":"","sources":["../../src/providers/rave-provider.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,UAAU,EAAE,MAAM,eAAe,CAAC;AAC3C,OAAO,EAAE,IAAI,EAAE,MAAM,iBAAiB,CAAC;AAGvC,OAAO,EAAE,UAAU,EAAE,MAAM,sBAAsB,CAAC;AAElD,OAAO,CAAC,6BAA6B,CAAC,CAAC;;IAKnC,cAAmB,IAAU,EAAU,IAAgB;QAApC,SAAI,GAAJ,IAAI,CAAM;QAAU,SAAI,GAAJ,IAAI,CAAY;KACtD;IAED;;;;OAIG;;;;;;IACH,mBAAI;;;;;IAAJ,UAAK,UAAgB,EAAE,UAAU;QAAjC,iBAQC;QARI,2BAAA,EAAA,kBAAgB;QACjB,MAAM,CAAC,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;YAC/B,EAAE,CAAA,CAAC,UAAU,IAAI,SAAS,CAAC;gBAAC,MAAM,CAAC,mCAAmC,CAAC,CAAC;YACxE,EAAE,CAAC,CAAC,UAAU,CAAC;gBAAC,KAAI,CAAC,GAAG,GAAG,KAAI,CAAC,IAAI,CAAC,IAAI,CAAC;YAC1C,IAAI;gBAAC,KAAI,CAAC,GAAG,GAAG,KAAI,CAAC,IAAI,CAAC,OAAO,CAAC;YAClC,KAAI,CAAC,IAAI,CAAC,SAAS,GAAG,UAAU,CAAC;YACjC,OAAO,CAAC,IAAI,CAAC,CAAA;SAChB,CAAC,CAAA;KACL;IAED;;;OAGG;;;;;IACH,wBAAS;;;;IAAT,UAAU,aAAyB;QAAnC,iBASC;QARG,MAAM,CAAC,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;YAC/B,aAAa,CAAC,WAAW,CAAC,GAAG,KAAI,CAAC,IAAI,CAAC,SAAS,CAAC;YACjD,MAAM,CAAC,KAAI,CAAC,IAAI,CAAC,IAAI,CAAC,0EAA0E,EAAE,aAAa,EAAE,EAAC,OAAO,EAAE,EAAC,cAAc,EAAE,kBAAkB,EAAC,EAAC,CAAC;iBAC5J,SAAS,CAAC,UAAA,QAAQ;gBACf,EAAE,CAAA,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,OAAO,CAAC;oBAAC,MAAM,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAA;gBAC7D,IAAI;oBAAC,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,CAAC,CAAA;aACzC,CAAC,CAAA;SACT,CAAC,CAAA;KACL;IAED;;;OAGG;;;;;IACH,qBAAM;;;;IAAN,UAAO,WAAW;;QAEd,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAC;KACtC;;gBA3CJ,UAAU;;;;gBAPF,IAAI;gBAGJ,UAAU;;eAJnB;;SASa,IAAI","sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { Misc } from './misc-provider';\r\nimport { RavePayment } from './rave-payment-provider';\r\n\r\nimport { HttpClient } from '@angular/common/http';\r\n\r\nrequire('cordova-plugin-inappbrowser');\r\n\r\n@Injectable()\r\nexport class Rave {\r\n    uri: string;\r\n    constructor(public misc: Misc, private http: HttpClient) {\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param production \r\n     * @param public_key \r\n     */\r\n    init(production=false, public_key) {\r\n        return new Promise((resolve, reject) => {\r\n            if(public_key == undefined) reject(\"Please pass in a valid public key\");\r\n            if (production) this.uri = this.misc.live;\r\n            else this.uri = this.misc.sandbox;\r\n            this.misc.PBFPubKey = public_key;\r\n            resolve(true)\r\n        })    \r\n    }\r\n\r\n    /**\r\n     * Returns a payment link that can be used to spin up the modal\r\n     * @param paymentObject \r\n     */\r\n    preRender(paymentObject:RavePayment) {\r\n        return new Promise((resolve, reject) => {\r\n            paymentObject['PBFPubKey'] = this.misc.PBFPubKey;\r\n            return this.http.post('https://ravesandboxapi.flutterwave.com/flwv3-pug/getpaidx/api/v2/hosted/', paymentObject, {headers: {'content-type': 'application/json'}})\r\n                .subscribe(response => {\r\n                    if(response[\"status\"] == \"error\") reject(response[\"message\"])\r\n                    else resolve(response[\"data\"][\"link\"])\r\n                })\r\n        })\r\n    }\r\n\r\n    /**\r\n     * Spins up the modal\r\n     * @param paymentLink \r\n     */\r\n    render(paymentLink) {\r\n        //@ts-ignore\r\n        window.open(paymentLink, '_blank');\r\n    }\r\n    \r\n}\r\n\r\n"]}